const axios = require('axios');
const crypto = require('crypto');

const email = 'thefcooperation@gmail.com';
const password = 'Onyedika';

// Hash the password with SHA1
const passwordDigest = crypto.createHash('sha1').update(password).digest('hex');

console.log('ğŸ” pCloud Inspector');
console.log('ğŸš€ Initializing...');
console.log('ğŸ”§ Logging in...');

axios.get('https://api.pcloud.com/login', {
  params: {
    username: email,
    passworddigest: passwordDigest,
    digest: 'sha1',
    getauth: 1,
  }
})
.then(res => {
  if (res.data.result === 0) {
    console.log('âœ… Logged in successfully!');
    const authToken = res.data.auth;
    console.log('ğŸ”‘ Auth Token:', authToken);

    console.log('ğŸ“‚ Fetching file list...');
    return axios.get('https://api.pcloud.com/listfolder', {
      params: {
        auth: authToken,
        folderid: 0
      }
    });
  } else {
    throw new Error(`Login failed: ${JSON.stringify(res.data)}`);
  }
})
.then(fileRes => {
  const files = fileRes.data.metadata.contents || [];
  console.log(`ğŸ“„ Total items: ${files.length}`);
  files.forEach(file => {
    console.log(`${file.isfolder ? 'ğŸ“ Folder:' : 'ğŸ“„ File:'} ${file.name}`);
  });
})
.catch(err => {
  console.error('âŒ Error:', err.message);
});
