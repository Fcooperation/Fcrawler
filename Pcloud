const axios = require("axios");
const fs = require("fs");
const path = require("path");
const FormData = require("form-data");

// Use your saved auth token
const AUTH_TOKEN = "d7C3SkZsOdg7ZRzm4A1QH7GFzuy1tbNXqSBAxr0M7";
const FILE_PATH = "video_thumbnail.png";

(async () => {
  try {
    const fileStream = fs.createReadStream(FILE_PATH);
    const form = new FormData();
    form.append("file", fileStream);

    const uploadRes = await axios.post(
      `https://api.pcloud.com/uploadfile?auth=${AUTH_TOKEN}&filename=${path.basename(FILE_PATH)}`,
      form,
      { headers: form.getHeaders() }
    );

    if (uploadRes.data.result === 0) {
      console.log("✅ Upload successful:", uploadRes.data.metadata.name);
    } else {
      console.error("❌ Upload failed:", uploadRes.data);
    }
  } catch (err) {
    console.error("❌ Error:", err.message);
  }
})();
